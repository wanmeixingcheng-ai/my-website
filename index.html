<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <title>KOTYO Intelligence Monitor</title>
    <style>
        body { background: #0d1117; color: #c9d1d9; font-family: sans-serif; padding: 20px; line-height: 1.6; }
        .container { max-width: 800px; margin: 0 auto; }
        .status-bar { background: #161b22; border: 1px solid #30363d; padding: 10px 15px; border-radius: 6px; margin-bottom: 20px; font-size: 13px; border-left: 4px solid #f85149; }
        .card { background: #161b22; border: 1px solid #30363d; padding: 20px; border-radius: 8px; margin-bottom: 15px; transition: 0.2s; }
        .card:hover { border-color: #58a6ff; }
        .meta { font-size: 11px; color: #8b949e; text-transform: uppercase; letter-spacing: 1px; margin-bottom: 10px; display: flex; justify-content: space-between; }
        .headline { font-size: 18px; font-weight: bold; color: #fff; margin: 0; }
        .badge { background: #238636; color: white; padding: 2px 8px; border-radius: 10px; font-size: 10px; }
    </style>
</head>
<body>

<div class="container">
    <h2 style="color:#f85149">ğŸ“¡ KOTYO å®æˆ˜æƒ…æŠ¥æµ</h2>
    <div id="status" class="status-bar">æ­£åœ¨åˆå§‹åŒ–å«æ˜Ÿé“¾æ¥...</div>
    <div id="feed"></div>
</div>

<script>
    // åŸºäºä½ æä¾›çš„æœ€æ–°ä¿¡æ¯
    const pA = "patR3J9RQjyCdCKcN";
    const pB = "c12832bf555d070c5b7c26130ada69e2c8b29b1c3ed990e176745682313fdc1b";
    const TOKEN = pA + "." + pB;
    const BASE_ID = "app1bKpTNxXpFD9jK";
    const TABLE_NAME = "Intelligence Entries"; // ç¡®è®¤è‡ªæˆªå›¾ï¼šDataæ¨¡å¼ä¸‹çš„æ ‡ç­¾å

    async function loadIntelligence() {
        const feed = document.getElementById('feed');
        const status = document.getElementById('status');

        try {
            const url = `https://api.airtable.com/v0/${BASE_ID}/${encodeURIComponent(TABLE_NAME)}?sort%5B0%5D%5Bfield%5D=Region&sort%5B0%5D%5Bdirection%5D=desc`;
            const resp = await fetch(url, { headers: { Authorization: `Bearer ${TOKEN}` } });

            if (!resp.ok) throw new Error("æ— æ³•è¯»å–æ•°æ®ï¼Œè¯·ç¡®è®¤Airtableä¸­åˆ—åæ˜¯å¦æœ‰Headline");

            const data = await resp.json();
            status.innerHTML = `â— ç³»ç»Ÿåœ¨çº¿ | å·²åŒæ­¥ ${data.records.length} æ¡æƒ…æŠ¥è®°å½•`;
            
            feed.innerHTML = data.records.map(r => `
                <div class="card">
                    <div class="meta">
                        <span>æ¥æº: ${r.fields.Source || 'OSINT'}</span>
                        <span class="badge">${r.fields.Region || 'GLOBAL'}</span>
                    </div>
                    <p class="headline">${r.fields.Headline || 'æƒ…æŠ¥å†…å®¹åŠ è½½ä¸­...'}</p>
                </div>
            `).join('');

        } catch (err) {
            status.innerHTML = "âŒ é“¾æ¥å¤±è´¥ï¼šè¯·ç¡®ä¿Airtableè¡¨æ ¼ä¸­æœ‰ä¸€åˆ—åä¸º Headline (æ³¨æ„é¦–å­—æ¯å¤§å†™)";
            status.style.borderColor = "#f85149";
        }
    }

    loadIntelligence();
    // æ¯åˆ†é’Ÿè‡ªåŠ¨åˆ·æ–°
    setInterval(loadIntelligence, 60000);
</script>

</body>
</html>
